# CORS is handled by PHP (config/cors.php) - do NOT set CORS headers here
# This prevents duplicate headers and conflicts with PHP CORS handler

# PHP settings
<IfModule mod_php.c>
    php_flag session.cookie_httponly on
    php_flag session.cookie_secure off
    php_flag session.cookie_samesite "Lax"
    php_flag output_buffering on
</IfModule>

# Security headers
<IfModule mod_headers.c>
    # Security headers
    Header set X-Content-Type-Options "nosniff"
    Header set X-XSS-Protection "1; mode=block"
    Header set X-Frame-Options "SAMEORIGIN"
    
    # Prevent MIME type sniffing
    Header always set X-Content-Type-Options "nosniff"
    
    # Ensure Authorization header is passed to PHP (for JWT authentication)
    SetEnvIf Authorization "(.*)" HTTP_AUTHORIZATION=$1
</IfModule>

# Prevent directory listing
Options -Indexes

# Prevent access to sensitive files
<FilesMatch "^\.|composer\.json|composer\.lock|package\.json|yarn\.lock$">
    Require all denied
</FilesMatch>